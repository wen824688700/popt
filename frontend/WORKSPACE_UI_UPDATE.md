# 工作台页面 UI 改造说明

## 改造内容

### 1. 背景颜色调整
- **首页和工作台页面**：统一使用深蓝灰色背景 `#1a2332`
- **次级背景**：`#242d3d`
- **边框颜色**：`#3d4a5c`
- **文字颜色**：白色和灰色系

### 2. 工作台页面布局重构
采用三栏布局：

#### 左侧：版本历史面板（宽度 256px）
- 显示所有历史版本列表
- 支持单选查看版本内容
- 支持多选（最多2个）进行版本对比
- 每个版本显示：
  - 版本号（v2.0, v2.1 等）
  - 时间戳（相对时间：刚刚、X分钟前、X小时前）
  - 版本类型（手动保存/优化生成）
  - 内容预览
  - 恢复按钮

#### 中间：编辑器面板
- 深色主题编辑器
- 模拟终端样式（红黄绿三色圆点）
- 自动保存功能
- 重新生成按钮

#### 右侧：输出区域/版本对比区域
**单版本模式**：
- 显示当前版本内容
- 提供复制、修改、保存按钮
- 模拟终端样式展示

**版本对比模式**（选择2个版本时自动切换）：
- 左右并排显示两个版本
- 高亮显示差异：
  - 红色背景：删除的内容
  - 绿色背景：新增的内容
  - 灰色：未改变的内容
- 显示统计信息（删除X行，新增X行）
- 提供合并和恢复按钮

### 3. UI 组件样式
所有编辑区域和输出区域都采用：
- 深色背景 `#242d3d`
- 圆角边框 `rounded-lg`
- 边框颜色 `#3d4a5c`
- 模拟终端头部（红黄绿三色圆点）

### 4. 新增组件

#### VersionHistory.tsx
- 版本历史列表组件
- 支持版本选择和恢复
- 显示当前版本标记

#### VersionComparison.tsx
- 版本对比组件
- 实现简单的行级 diff 算法
- 左右并排显示差异

## 技术实现

### 状态管理
```typescript
- selectedVersionIds: string[]  // 选中的版本ID（最多2个）
- viewMode: 'editor' | 'comparison'  // 视图模式
- currentVersionId: string  // 当前版本ID
```

### 交互逻辑
1. 点击单个版本 → 在右侧显示该版本内容
2. 选择两个版本 → 自动切换到对比模式
3. 取消选择 → 返回编辑器模式
4. 恢复版本 → 将版本内容加载到编辑器

### Diff 算法
使用简单的行级对比：
- 逐行比较两个版本
- 标记删除、新增、未改变的行
- 保留行号用于显示

## 文件变更

### 新增文件
- `frontend/components/VersionHistory.tsx` - 版本历史组件
- `frontend/components/VersionComparison.tsx` - 版本对比组件

### 修改文件
- `frontend/app/workspace/page.tsx` - 重构为三栏布局
- `frontend/components/EditorPanel.tsx` - 深色主题样式
- `frontend/components/MarkdownTab.tsx` - 深色主题样式
- `frontend/app/globals.css` - 添加深色主题CSS变量

## 使用说明

### 查看版本
1. 在左侧版本历史中点击任意版本
2. 右侧会显示该版本的完整内容

### 对比版本
1. 在左侧版本历史中点击第一个版本（会显示蓝色选中状态）
2. 再点击第二个版本
3. 右侧自动切换到对比视图，显示两个版本的差异

### 恢复版本
1. 点击版本卡片上的"恢复此版本"按钮
2. 该版本内容会加载到编辑器和输出区

### 保存新版本
1. 在编辑器中修改内容
2. 点击"重新生成"按钮生成新版本
3. 或在输出区点击"保存"按钮手动保存

## 注意事项

1. 版本历史最多显示最近的版本（可根据需要调整）
2. 版本对比使用简单的行级算法，对于大文件可能需要优化
3. 所有版本数据目前存储在组件状态中，刷新页面会丢失（后续可接入后端API持久化）
4. 深色主题的颜色可以根据设计需求进一步调整

## 后续优化建议

1. **性能优化**：
   - 对于大文件，使用虚拟滚动
   - 优化 diff 算法，使用更高效的算法（如 Myers diff）

2. **功能增强**：
   - 支持版本标签和备注
   - 支持版本搜索和筛选
   - 支持导出版本历史

3. **用户体验**：
   - 添加版本对比的快捷键
   - 支持拖拽调整面板宽度
   - 添加版本对比的更多可视化选项（并排/上下）

4. **数据持久化**：
   - 接入后端 API 保存版本历史
   - 支持跨设备同步
